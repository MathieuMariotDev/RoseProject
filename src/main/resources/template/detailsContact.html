<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-Zenh87qX5JnK2Jl0vWa8Ck2rdkQ2Bzep5IDxbcnCeuOxjzrPF/et3URy9Bv1WTRi" crossorigin="anonymous">
  <link rel="stylesheet" type="text/css" href="../static/css/style.css" th:href="@{/css/style.css}">
  <title>home</title>
</head>
<body>

<div class="container-fluid row">
  <div th:insert="../fragments/header :: header">
  </div>
  <main>

      <div class="row">
      <div class="col-6">
        <img th:src="${contact.picture}" alt="" class="img-fluid"/>
      </div>
      <div class="col-6">

        <div class="card">
          <div class="card-body">
            <div class="card-text">
              <div class="d-flex align-items-center">
                <h3> <strong th:text="${contact.name} +'&nbsp'"/></h3>
                <h3><strong th:text="${contact.firstName}"/></h3>
              </div>
              <h4 th:text=" 'Adresse email : ' + ${contact.email}"></h4>
              <h4 th:text=" 'Numéro : ' + ${contact.phone}"></h4>
              <h4 th:text=" 'Numéro de protable: ' + ${contact.cellPhone}"></h4>
              <p th:text=" 'Nom de l  entreprise : ' + ${contact.entreprise.name}"></p>
              <p th:text=" 'Secteur d activité : ' + ${contact.entreprise.typeOfActivity}"></p>
              <p th:text=" 'Numéro de téléphone de l entreprise : ' + ${contact.entreprise.phone}"></p>
              <p th:text=" 'Adresse de l entreprise : '+ ${contact.entreprise.address}"></p>
              <p th:text=" 'Complément : '+ ${contact.entreprise.additionalAddress}"></p>
              <p th:text=" 'Ville : '+ ${contact.entreprise.city}"></p>

              <p>Lien vers le détails de son entreprise</p>
               <!-- TODO -->


              <a  th:href="@{/contact/delete/{id}(id=${contact.id})}" class="btn btn-danger">Supprimer ce contact</a>

            </div>
          </div>
        </div>
      </div>
    </div>
    <button type="button" id="buttonShowForm" class="btn btn-info">Ajouter une note ou demarrer la prospection</button>
    <div class="row justify-content-center" id="formAdd">

      </div>


        <th:block th:each="echange :${contact.getEchangesById()}">



          <div class="row justify-content-center">
            <!--Material textarea-->
            <h3><strong th:text="'Statut : ' +${echange.statusProspecting}"/></h3>
            <h4><strong th:text=" 'Date de création: ' +${echange.createDate}"/></h4>
          <div class="form-outline">
            <label for="textAreaExample1">Note sur l'échange</label>
            <textarea class="form-control" id="textAreaExample1" rows="4" th:text="${echange.message}
"  readonly></textarea>
          </div>
            <a  th:href="@{/echange/update/{id}/{idEchange} (id=${contact.id},idEchange=${echange.id})}" class="btn btn-warning">Mettre a jour l'échange</a>
            <a  th:href="@{/echange/delete/{id}/{idEchange} (id=${contact.id},idEchange=${echange.id})}" class="btn btn-danger">Supprimer l'échange</a>
          </div>
        </th:block>





  </main>
  <footer>

  </footer>
</div>

<script>

  let htmlFormAddEchange="<form th:action=\"@{/echange/update/{id}/{idEchange} (id=${contact.id},idEchange=${echange.id})}\" method=\"post\" th:object=\"${echange}\">\n" +
          "            <h3><strong th:text=\"'Statut actuelle : ' +${echange.statusProspecting}\"/></h3>\n" +
          "\n" +
          "\n" +
          "            <h4><strong th:text=\" 'Date de création: ' +${echange.createDate}\"/></h4>\n" +
          "            <div class=\"form-outline\">\n" +
          "                <label for=\"textAreaExample1\">Note sur l'échange</label>\n" +
          "                <textarea class=\"form-control\" id=\"textAreaExample1\" rows=\"4\" th:field=\"${echange.message}\" th:text=\"${echange.message}\n" +
          "\" ></textarea>\n" +
          "            </div>\n" +
          "                <button class=\"w-100 btn btn-lg btn-primary my-3\" type=\"submit\">Modifier l'échange</button>\n" +
          "            </form>"



let btnShow = document.getElementById("buttonShowForm");

  btnShow.addEventListener("click", ev => {
    console.log("clicked");
    document.getElementById("formAdd").innerHTML = htmlFormAddEchange;
  });



</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-OERcA2EqjJCMA+/3y+gxIOqMEjwtxJY7qPCqsdltbNJuaOe923+mo//f6V8Qbsw3"
        crossorigin="anonymous">




</script>
</body>
</html>